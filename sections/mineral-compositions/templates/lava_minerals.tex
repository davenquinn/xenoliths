\begin{tabular}{l<< " r"*(ncols-1) >>}
\toprule
  Mineral
  <#- for ox in oxides -#>
  & \ce{<< ox >>}
  <#- endfor #> & Total & Mg\# \\
\midrule
<#- for s in samples #>
  << s.mineral >> \hfill\textit{<< s.type >>}
  <#- for ox in oxides -#>
  & << s[ox]|n >>
  <#- endfor -#>
  & << s.oxide_total|n >>
  & << s.mg_number|n >> \\
<#- endfor #>
\bottomrule
\end{tabular}

