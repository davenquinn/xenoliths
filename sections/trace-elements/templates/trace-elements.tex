<# macro loop(data) -#>
  <#- for i,row in data #>
    << row.sample_id >>
    <#- for el in elements -#>
    & << row[el]|n >>
    <#- endfor #> & << row.n|n(0) >> \\
  <#- endfor #>
<#- endmacro #>
\begin{tabular}{l<< " r"*(ncols-1) >>}
\toprule
  Sample
  <#- for el in elements -#>
  & \ce{<< el >>}
  <#- endfor #> & \textit{n} \\
\midrule
  \multicolumn{<<ncols>>}{l}{\textit{Clinopyroxene}} \\
\midrule
<< loop(cpx) >>
\midrule
  \multicolumn{<<ncols>>}{l}{\textit{Orthopyroxene}} \\
\midrule
<< loop(opx) >>
\midrule
  \multicolumn{<<ncols>>}{l}{\textit{Whole-rock (recalculated from modal mineralogy)}} \\
\midrule
<< loop(whole_rock) >>
\bottomrule
\end{tabular}


